@startuml

package runtime {
	class RuntimeEngine {
		+ currentTags : DataTags
		+ nodeStack: Stack<DecisionNode>
		getState() : state
		restoreState( state )
		consume( ans:Answer )
	}

	class RuntimeEntity {
		+ id : String
		+ title : String
		+ info  : String
	}

	class FlowChartSet {
		+ source : URL
		+ charts : FlowChart[]
		+ tagTypes : TagType[]
	}

	class FlowChart {
		+ source : URL
		+ start  : DecisionNode
		+ nodes  : DecisionNode[]
	}

	class Node {
		+ chart : FlowChart
	}

	class DecisionNode {
		+ dataTags : DataTags
		+ yes : DecisionNode
		+ no  : DecisionNode
	}

	class CallNode {
		+ calleeChartId : String
		+ calleeNodeId  : String
		+ nextNode : Node
	}

	class EndNode

	enum Answer {
		YES
		NO
	}
}

package model {
	class DataTags {
		+ tags : Map<TagType<TagValue>,TagValue>
		compose( t:DataTags ): DataTags
	}

	package types {
		class TagType {
			+ name:String
			+ info:String
		}

		class ToDoType {
			
		}

		class SimpleValueType {
			+ values: TagValue[]
		}

		class AggregateType {
			+ itemType: TagType
		}
	}
	package values {
		class TagValue {
			+ name: String
			+ type: TagType
			+ info: String
		}

		class SimpleValue <<Comparable>> {
			+ ordinal: int
		}

		class ToDoValue {
			
		}

		class AggregateValue {
			values: TagValue[]
		}
	}
}

RuntimeEngine --> DataTags : currentTags
RuntimeEngine --> "1..*" Node : nodeStack

RuntimeEngine --> FlowChartSet : chartSet
note on link
	The program executed
	by the runtime 
end note
RuntimeEntity <|-- Node
RuntimeEntity <|-- FlowChart
RuntimeEntity <|-- FlowChartSet
Node <|-- DecisionNode
Node <|-- CallNode
Node <|-- EndNode
TagType <|-- ToDoType
TagType <|-- SimpleValueType
TagType <|-- AggregateType
TagValue <|-- ToDoValue
TagValue <|-- AggregateValue
TagValue <|-- SimpleValue

FlowChartSet "1" --> "1..*" FlowChart : charts
note on link: Mapped by name

FlowChart --> Node : start
CallNode --> Node : nextNode

DecisionNode --> Node: YES
DecisionNode --> Node: NO
DecisionNode --> FlowChart : chart
DecisionNode --> DataTags : assumption

DataTags --> "0..*" TagType : types
DataTags --> "0..*" TagValue 
note on link: Mapped by TagType

AggregateValue ---> "0..*" TagValue

AggregateType --> TagType : itemType

FlowChartSet --> "0..*" TagType : tagTypes

TagValue --> TagType : type



@enduml