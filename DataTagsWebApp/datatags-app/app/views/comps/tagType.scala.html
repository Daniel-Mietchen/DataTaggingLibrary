@( tagType: edu.harvard.iq.datatags.model.types.TagType )

@import edu.harvard.iq.datatags.model.types._

@simpleType( tp: SimpleType ) = {
  <div class="tagtype tagtype-simple">
    <span class="typeName">@tp.getName</span>
    <span class="typeValues">
      @for( sv <- tp.values ) {
        @if( sv.getInfo==null ) {
          <span class="valueAtom">@sv.getName</span>
        } else {
          <span class="valueAtom" data-toggle="popover" data-trigger="hover" 
             title="@sv.getName" data-content="@sv.getInfo"
             data-placement="top">
            @sv.getName
            <span class="glyphicon glyphicon-info-sign"></span>
          </span>
        }
      }
    </span>
    <small>Single value</small>
  </div>
}

@aggregateType( tp: AggregateType ) = {
  <div class="tagtype tagtype-aggregate">
    <span class="typeName">@tp.getName</span>
    <span class="typeValues">
      @for( sv <- tp.getItemType.values ) {
        @if( sv.getInfo==null ) {
            <span class="valueAtom">@sv.getName</span>
          } else {
            <span class="valueAtom" data-toggle="popover" data-trigger="hover" 
               title="@sv.getName" data-content="@sv.getInfo"
               data-placement="top">
              @sv.getName
              <span class="glyphicon glyphicon-info-sign"></span>
            </span>
          }
        }
    </span>
    <small>Multiple values</small>
  </div>
}

@compoundType( tp:CompoundType ) = {
 <div class="tagtype tagtype-compound">
    <div>
      @if( tp.getInfo != null ) {
        <span data-toggle="popover" data-trigger="hover" 
             title="@tp.getName" data-content="@tp.getInfo"
             data-placement="top">
            <span class="typeName">@tp.getName
              <span class="glyphicon glyphicon-info-sign"></span>
            </span>
        </span>
      } else {
        <span class="typeName">@tp.getName</span>
      }
    </div>
    <div class="typeValues">
      @for( ft <- tp.getFieldTypes ) {
        @renderType( ft )
      }
    </div>
  </div> 
}

@todoType( tp: ToDoType ) = {
  <div class="tagtype tagtype-todo">
    <span class="typeName">@tp.getName</span>
    <span class="typeValues">
        <span class="valueAtom">TODO</span>
    </span>
    <small>value placeholder</small>
  </div>
}


@renderType( ft:TagType ) = {
  @ft match {
    case t:SimpleType => { @simpleType(t) }
    case t:AggregateType => { @aggregateType(t) }
    case t:CompoundType => { @compoundType(t) }
    case t:ToDoType => { @todoType(t) }
  }
}

@renderType( tagType )
